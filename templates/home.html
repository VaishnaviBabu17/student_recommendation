<!DOCTYPE html>
<html>

<head>
    <title>Student Academic Recommendation System</title>

    <style>
        body {
            font-family: Arial;
            margin: 30px;
        }

        .excellent {
            color: green;
            font-weight: bold;
        }

        .good {
            color: blue;
            font-weight: bold;
        }

        .average {
            color: orange;
            font-weight: bold;
        }

        .poor {
            color: red;
            font-weight: bold;
        }

        .card {
            border: 1px solid #ccc;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
        }
    </style>
</head>

<body>

<h2>Student Academic Recommendation System</h2>

<!-- ================== FORM 1 : STUDENT DETAILS ================== -->

<form method="POST">
    {% csrf_token %}
    <input type="hidden" name="action" value="load_subjects">

    <h3>Student Details</h3>

    Register No:
    <input type="text" name="reg_no" required><br><br>

    Name:
    <input type="text" name="name" required><br><br>

    Department:
    <input type="text" name="department" required><br><br>

    Year:
    <input type="number" name="year" required><br><br>

    Semester:
    <input type="number" name="semester" required><br><br>

    <input type="submit" value="Load Subjects">
</form>

<hr>

<!-- ================== FORM 2 : MARKS & ATTENDANCE ================== -->

{% if subjects %}

<h3>Enter Marks and Attendance</h3>

<form method="POST">
    {% csrf_token %}

    <input type="hidden" name="action" value="get_recommendation">

    {% for subject in subjects %}

        <h4>{{ subject }}</h4>

        <!-- ADD THIS LINE -->
        <input type="hidden" name="subjects" value="{{ subject }}">

        Marks:
        <input type="number" name="{{ subject }}_marks" required>

        Classes Attended:
        <input type="number" name="{{ subject }}_attended" required>

        Total Classes:
        <input type="number" name="{{ subject }}_total" required>

        <br><br>

    {% endfor %}

    <button type="submit">Get Recommendation</button>
</form>


<!-- ================== RESULT SECTION ================== -->

{% if recommendations %}

<h3>Overall Performance Summary</h3>

Average Marks: {{ overall_marks }} <br>
Average Attendance: {{ overall_attendance }} % <br>

Overall Performance:
<span class="
{% if overall_performance == 'Excellent' %}
excellent
{% elif overall_performance == 'Good' %}
good
{% elif overall_performance == 'Average' %}
average
{% else %}
poor
{% endif %}
">
{{ overall_performance }}
</span>

<br><br>

<strong>Strong Subjects:</strong>
<ul>
    {% for s in strong_subjects %}
        <li>{{ s }}</li>
    {% empty %}
        <li>None</li>
    {% endfor %}
</ul>

<strong>Weak Subjects:</strong>
<ul>
    {% for w in weak_subjects %}
        <li>{{ w }}</li>
    {% empty %}
        <li>None</li>
    {% endfor %}
</ul>

<hr>

<h3>Subject-wise Recommendations</h3>

{% for subject, data in recommendations.items %}

<div class="card">

<h4>{{ subject }}</h4>

Marks: {{ data.marks }} <br>
Attendance: {{ data.attendance }} % <br>

Performance:
<span class="
{% if data.performance == 'Excellent' %}
excellent
{% elif data.performance == 'Good' %}
good
{% elif data.performance == 'Average' %}
average
{% else %}
poor
{% endif %}
">
{{ data.performance }}
</span>

<br><br>

<b>Suggestions:</b>
<ul>
    {% for r in data.recommendations %}
        <li>{{ r }}</li>
    {% endfor %}
</ul>

</div>

{% endfor %}

{% endif %}

</body>
</html>
